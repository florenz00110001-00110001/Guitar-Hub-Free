<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Guitar Hub Trainer</title>
<style>
  :root{
    --bg:#111;
    --panel:#000;
    --accent:orange;
    --muted:#222;
    --text:#fff;
    --card:#1a1a1a;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:Arial, sans-serif;
    background:var(--bg);
    color:var(--text);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    text-align:center;
    transition:background 0.25s,color 0.25s;
  }
  header{
    width:100%;
    background:var(--panel);
    padding:10px 18px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    position:fixed;
    top:0; left:0;
    z-index:1000;
    box-shadow:0 2px 8px rgba(0,0,0,0.6);
  }
  .logo{display:flex;align-items:center;font-weight:700;font-size:1.25rem}
  .logo .guitar{color:#fff}
  .logo .hub{color:black;background:orange;padding:4px 8px;border-radius:6px;margin-left:8px}
  .controls{display:flex;gap:8px;align-items:center}
  main{padding:92px 14px 40px; max-width:980px;margin:0 auto;}
  button{padding:10px 16px;border-radius:8px;border:none;background:var(--accent);color:#000;font-weight:600;cursor:pointer}
  .back-btn{background:#444;color:#fff}
  .ghost{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,0.06);padding:8px 12px;border-radius:8px}
  .card{background:var(--muted);padding:14px;border-radius:10px;margin:12px 0;box-shadow:0 6px 16px rgba(0,0,0,0.6)}
  .hidden{display:none}
  .chord-grid{display:flex;flex-wrap:wrap;gap:14px;justify-content:center;padding:8px}
  .chord-card{width:120px;background:#222;padding:10px;border-radius:10px;box-shadow:0 6px 14px rgba(0,0,0,0.6);text-align:center}
  .chord-card img{width:100px;height:auto;display:block;margin:8px auto}
  .timer{font-weight:700;color:gold;font-size:1.2rem;margin:8px}
  #quiz-options button{display:block;width:100%;margin:8px 0;background:#333;color:#fff;padding:10px;border-radius:8px}
  input[type="text"],input[type="email"],input[type="password"]{
    width:100%;padding:10px;border-radius:8px;border:none;background:#1b1b1b;color:#fff;margin-bottom:10px;font-size:1rem;
  }
  .row{display:flex;gap:8px;align-items:center}
  .row .small{width:48px;padding:8px}
  .song{padding:10px;border-radius:8px;background:#171717;margin:8px 0;text-align:left}
  .song .title{font-weight:700}
  .song .meta{font-size:0.9rem;color:#ddd;margin-top:6px}
  #burger{font-size:1.4rem;background:none;border:none;color:#fff;cursor:pointer;padding:6px 8px}
  #account-panel{position:fixed;top:58px;right:12px;width:300px;background:#141414;padding:12px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,0.6);display:none;z-index:1100}
  #account-panel h4{margin:0 0 8px 0}
  @media (max-width:600px){
    .logo{font-size:1.05rem}
    main{padding:96px 12px}
    .chord-card{width:96px}
  }
  .light-mode{background:#fff;color:#000}
  .light-mode .logo .hub{background:orange;color:black}
  .light-mode button{color:#000}
</style>
</head>
<body>

<header>
  <div class="logo">
    <span class="guitar">Guitar</span><span class="hub">Hub</span>
  </div>
  <div class="controls">
    <button id="dark-toggle" title="Toggle theme">ğŸŒ—</button>
    <button id="burger" aria-label="Open account menu">â˜°</button>
  </div>
</header>

<div id="account-panel" aria-hidden="true">
  <h4>Account</h4>
  <p id="account-email">Not signed in</p>
  <div style="display:flex;gap:8px;margin-top:8px;">
    <button id="show-dashboard" class="ghost">Dashboard</button>
    <button id="signout-btn" class="ghost">Sign out</button>
  </div>
  <hr style="margin:10px 0;border-color:#222">
  <button id="change-pass" class="ghost" style="width:100%;margin-bottom:8px">Change password</button>
  <button id="delete-account" class="ghost" style="width:100%;color:#ff6666">Delete account</button>
</div>

<main>
  <div id="login-screen" class="card">
    <h1 style="margin:0 0 8px 0">Login</h1>
    <input id="email" type="email" placeholder="Email" autocomplete="username">
    <div class="row" style="align-items:center">
      <input id="password" type="password" placeholder="Password" autocomplete="current-password" style="flex:1">
      <button id="toggle-pass" class="ghost small" title="Show/Hide">ğŸ‘ï¸</button>
    </div>
    <div style="display:flex;gap:8px;justify-content:center;margin-top:8px">
      <button id="login-btn">Login</button>
      <button id="signup-btn" class="ghost">Sign up</button>
    </div>
    <div style="display:flex;gap:8px;justify-content:center;margin-top:10px">
      <button id="continue-btn" class="ghost">Continue without account</button>
    </div>
    <p style="margin:12px 0 0 0"><a href="#" id="forgot-link" style="color:#ddd">Forgot password?</a></p>
    <p id="auth-msg" style="color:#f88;margin-top:8px"></p>
  </div>

  <div id="main-menu" class="card hidden">
    <h2 style="margin-top:0">Main Menu</h2>
    <div style="display:flex;flex-wrap:wrap;gap:10px;justify-content:center">
      <button onclick="showChords()">View Chords</button>
      <button onclick="showPractice()">Practice Chords</button>
      <button onclick="showStrum()">Practice Strum</button>
      <button onclick="showQuiz()">Chord Recognition Quiz</button>
      <button onclick="learnSongs()" class="ghost">Learn Songs</button>
      <button onclick="window.open('https://www.guitartuna.com/', '_blank')" class="ghost">Tune with GuitarTuna</button>
    </div>
  </div>

  <div id="chords" class="card hidden">
    <h2 style="margin-top:0">Basic Chords</h2>
    <div class="chord-grid" id="chord-grid"></div>
    <button class="back-btn" onclick="goBack()">â¬… Back</button>
  </div>

  <div id="practice" class="card hidden">
    <h2 style="margin-top:0">Practice Chords (Random)</h2>
    <div id="practice-chord-display" style="font-size:2rem;margin:16px"></div>
    <div style="display:flex;gap:8px;justify-content:center">
      <button id="next-chord">Next Chord</button>
      <button id="play-chord" class="ghost">Play (placeholder)</button>
    </div>
    <p id="practice-feedback" style="margin-top:10px"></p>
    <button class="back-btn" onclick="goBack()">â¬… Back</button>
  </div>

  <div id="strum" class="card hidden">
    <h2 style="margin-top:0">Practice Strum</h2>
    <input id="song-search" type="text" placeholder="Search songs..." style="margin-bottom:12px" />
    <div id="song-list" style="max-height:360px;overflow:auto;padding-right:6px"></div>
    <div style="margin-top:12px">
      <p id="song-pattern" style="font-weight:700">Pattern: â€”</p>
      <button id="start-mic" class="ghost">Start Mic Test</button>
      <p id="strum-feedback" style="margin-top:8px"></p>
    </div>
    <button class="back-btn" onclick="goBack()">â¬… Back</button>
  </div>

  <div id="quiz" class="card hidden">
    <h2 style="margin-top:0">Chord Recognition Quiz</h2>
    <div style="margin-bottom:12px">
      <button id="start-quiz">Start Quiz</button>
      <button id="reset-quiz" class="ghost" style="display:none">Reset</button>
    </div>
    <div id="quiz-area" class="hidden" style="text-align:center">
      <div class="timer" id="timer">5</div>
      <div id="quiz-image" style="margin:8px"></div>
      <div id="quiz-options" style="max-width:420px;margin:0 auto;text-align:center"></div>
      <p id="quiz-progress" style="margin-top:8px"></p>
    </div>
    <div id="quiz-result" class="hidden" style="margin-top:12px;font-weight:700"></div>
    <button class="back-btn" onclick="goBack()">â¬… Back</button>
  </div>
</main>

<!-- Firebase & App Logic -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, sendPasswordResetEmail, onAuthStateChanged, updatePassword, deleteUser } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDkMmF78dFu2dmuzka6xuwpLRD5NRCCJtY",
    authDomain: "guitar-hub-25dfa.firebaseapp.com",
    projectId: "guitar-hub-25dfa",
    storageBucket: "guitar-hub-25dfa.appspot.com",
    messagingSenderId: "36479296604",
    appId: "1:36479296604:web:5dbcfb2aec3912f8ba7299",
    measurementId: "G-N4HZW695LF"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  const loginScreen = document.getElementById("login-screen");
  const mainMenu = document.getElementById("main-menu");
  const chordsPanel = document.getElementById("chords");
  const practicePanel = document.getElementById("practice");
  const strumPanel = document.getElementById("strum");
  const quizPanel = document.getElementById("quiz");
  const accountPanel = document.getElementById("account-panel");

  const emailInput = document.getElementById("email");
  const passwordInput = document.getElementById("password");
  const authMsg = document.getElementById("auth-msg");
  const burgerBtn = document.getElementById("burger");
  const accountEmail = document.getElementById("account-email");

  document.getElementById("dark-toggle").addEventListener("click", ()=> {
    document.body.classList.toggle("light-mode");
  });

  burgerBtn.addEventListener("click", ()=>{
    accountPanel.style.display = accountPanel.style.display === "block" ? "none" : "block";
  });

  document.getElementById("toggle-pass").addEventListener("click", ()=>{
    passwordInput.type = passwordInput.type === "password" ? "text" : "password";
  });

  document.getElementById("signup-btn").addEventListener("click", async ()=>{
    const email = emailInput.value.trim();
    const pw = passwordInput.value;
    if(!email || !pw){ authMsg.textContent = "Provide email & password to sign up."; return; }
    try{
      await createUserWithEmailAndPassword(auth, email, pw);
      authMsg.style.color = "#8f8"; authMsg.textContent = "Account created, signed in.";
    }catch(e){ authMsg.style.color="#f88"; authMsg.textContent = e.message; }
  });

  document.getElementById("login-btn").addEventListener("click", async ()=>{
    const email = emailInput.value.trim();
    const pw = passwordInput.value;
    if(!email || !pw){ authMsg.textContent = "Enter email & password to sign in."; authMsg.style.color="#f88"; return; }
    try{
      await signInWithEmailAndPassword(auth, email, pw);
      authMsg.style.color="#8f8"; authMsg.textContent = "Signed in.";
    }catch(e){ authMsg.style.color="#f88"; authMsg.textContent = e.message; }
  });

  document.getElementById("continue-btn").addEventListener("click", ()=>{
    loginScreen.classList.add("hidden");
    mainMenu.classList.remove("hidden");
    accountEmail.textContent = "Guest";
  });

  document.getElementById("forgot-link").addEventListener("click", async (ev)=>{
    ev.preventDefault();
    const email = emailInput.value.trim();
    if(!email){ authMsg.style.color="#f88"; authMsg.textContent = "Enter your email then click Reset."; return; }
    try{
      await sendPasswordResetEmail(auth, email);
      authMsg.style.color="#8f8"; authMsg.textContent = "Reset email sent (check inbox).";
    }catch(e){ authMsg.style.color="#f88"; authMsg.textContent = e.message; }
  });

  document.getElementById("signout-btn").addEventListener("click", async ()=>{
    try{ await signOut(auth); loginScreen.classList.remove("hidden"); mainMenu.classList.add("hidden"); accountPanel.style.display='none'; accountEmail.textContent='Not signed in'; authMsg.textContent=''; }
    catch(e){ console.error(e); }
  });

  document.getElementById("change-pass").addEventListener("click", async ()=>{
    const newPass = prompt("Enter new password (min 6 chars):");
    if(!newPass) return;
    if(!auth.currentUser){ alert("Sign in required to change password."); return; }
    try{
      await updatePassword(auth.currentUser, newPass);
      alert("Password updated.");
    }catch(e){ alert(e.message); }
  });

  document.getElementById("delete-account").addEventListener("click", async ()=>{
    if(!auth.currentUser){ alert("Not signed in."); return; }
    if(!confirm("Delete your account permanently?")) return;
    try{
      await deleteUser(auth.currentUser);
      alert("Account deleted.");
      loginScreen.classList.remove("hidden"); mainMenu.classList.add("hidden");
    }catch(e){
      alert("Delete failed: "+e.message);
    }
  });

  onAuthStateChanged(auth, (user)=>{
    if(user){
      accountEmail.textContent = user.email || "User";
      loginScreen.classList.add("hidden");
      mainMenu.classList.remove("hidden");
      authMsg.textContent = "";
    }
  });

  // --- Chords ---
  const chords = ["C","D","E","F","G","A","B","Am","Dm","Em","F#m","Bm","Cmaj7","C#m","G#m"];
  const chordGrid = document.getElementById("chord-grid");
  function populateChordGrid(){
    chordGrid.innerHTML = "";
    chords.forEach(chord=>{
      const card = document.createElement("div");
      card.className = "chord-card";
      const fname = chord.toLowerCase().replace("#","sharp").replace("+","plus") + "m.png";
      card.innerHTML = `<div style="font-weight:700">${chord}</div><img src="image/${fname}" alt="${chord} chord" onerror="this.onerror=null;this.src='image/placeholder.png'">`;
      chordGrid.appendChild(card);
    });
  }
  populateChordGrid();

  // --- Practice ---
  const practiceDisplay = document.getElementById("practice-chord-display");
  document.getElementById("next-chord").addEventListener("click", ()=> {
    const ch = chords[Math.floor(Math.random()*chords.length)];
    practiceDisplay.textContent = ch;
    document.getElementById("practice-feedback").innerHTML = `<img src="image/${ch.toLowerCase().replace("#","sharp")}m.png" style="width:150px" onerror="this.onerror=null;this.style.display='none'">`;
  });

  // --- Song List & Strum ---
  const songs = [
    {name:"Wonderwall - Oasis", chords:"Em7 G Dsus4 A7sus4", pattern:"â†“ â†“ â†‘ â†‘ â†“ â†‘"},
    {name:"Knockin' on Heaven's Door - Bob Dylan", chords:"G D Am G D C", pattern:"â†“ â†“ â†‘ â†“ â†‘"},
    {name:"Zombie - The Cranberries", chords:"Em C G D", pattern:"â†“ â†‘ â†“ â†‘"},
    {name:"Let It Be - The Beatles", chords:"C G Am F", pattern:"â†“ â†“ â†‘ â†“ â†“ â†‘ â†“ â†“ â†‘</p>
        </div>
        <div class="song">
            <h3>Wonderwall â€“ Oasis</h3>
            <p>Chords: Em G D A7sus4 C</p>
            <p>Strumming: â†“ â†“ â†‘ â†‘ â†“ â†‘</p>
        </div>
        <div class="song">
            <h3>Perfect â€“ Ed Sheeran</h3>
            <p>Chords: G Em C D</p>
            <p>Strumming: â†“ â†“ â†‘ â†‘ â†“ â†‘</p>
        </div>
        <div class="song">
            <h3>Shape of You â€“ Ed Sheeran</h3>
            <p>Chords: C#m F#m A B</p>
            <p>Strumming: â†“ â†‘ â†“ â†‘ â†“ â†‘</p>
        </div>
        <div class="song">
            <h3>Hallelujah â€“ Leonard Cohen</h3>
            <p>Chords: C Am F G</p>
            <p>Strumming: â†“ â†“ â†‘ â†‘ â†“ â†‘</p>
        </div>
        <div class="song">
            <h3>Stand by Me â€“ Ben E. King</h3>
            <p>Chords: G Em C D</p>
            <p>Strumming: â†“ â†“ â†‘ â†‘ â†“ â†‘</p>
        </div>
        <div class="song">
            <h3>Knockin' on Heaven's Door â€“ Bob Dylan</h3>
            <p>Chords: G D Am C</p>
            <p>Strumming: â†“ â†“ â†‘ â†“ â†“ â†‘</p>
        </div>
        <div class="song">
            <h3>Chasing Cars â€“ Snow Patrol</h3>
            <p>Chords: A E D</p>
            <p>Strumming: â†“ â†‘ â†“ â†‘</p>
        </div>
        <div class="song">
            <h3>All of Me â€“ John Legend</h3>
            <p>Chords: Em C G D Am</p>
            <p>Strumming: â†“ â†“ â†‘ â†‘ â†“ â†‘</p>
        </div>
        <div class="song">
            <h3>Yellow â€“ Coldplay</h3>
            <p>Chords: Bm D A E</p>
            <p>Strumming: â†“ â†“ â†‘ â†‘ â†“ â†‘</p>
        </div>
        <div class="song">
            <h3>Zombie â€“ The Cranberries</h3>
            <p>Chords: Em C G D/F#</p>
            <p>Strumming: â†“ â†“ â†‘ â†‘ â†“ â†‘</p>
        </div>
        <div class="song">
            <h3>Love Yourself â€“ Justin Bieber</h3>
            <p>Chords: C G Am F</p>
            <p>Strumming: â†“ â†‘ â†“ â†‘</p>
        </div>
        <div class="song">
            <h3>Hotel California â€“ Eagles</h3>
            <p>Chords: Bm F# A E G D Em F#</p>
            <p>Strumming: â†“ â†“ â†‘ â†‘ â†“ â†‘</p>
        </div>
        <div class="song">
            <h3>Let Her Go â€“ Passenger</h3>
            <p>Chords: C G Am F</p>
            <p>Strumming: â†“ â†“ â†‘ â†‘ â†“ â†‘</p>
        </div>
    </section>
</main>

<!-- Scripts -->
<script type="module">
  // Firebase setup
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDkMmF78dFu2dmuzka6xuwpLRD5NRCCJtY",
    authDomain: "guitar-hub-25dfa.firebaseapp.com",
    projectId: "guitar-hub-25dfa",
    storageBucket: "guitar-hub-25dfa.firebasestorage.app",
    messagingSenderId: "36479296604",
    appId: "1:36479296604:web:5dbcfb2aec3912f8ba7299",
    measurementId: "G-N4HZW695LF"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // UI Elements
  const loginScreen = document.getElementById("login-screen");
  const mainContent = document.getElementById("main-content");
  const loginForm = document.getElementById("login-form");
  const signupForm = document.getElementById("signup-form");
  const continueBtn = document.getElementById("continue-btn");
  const forgotPasswordBtn = document.getElementById("forgot-password-btn");
  const togglePassword = document.getElementById("toggle-password");

  // Continue without account
  continueBtn.addEventListener("click", () => {
    loginScreen.classList.add("hidden");
    mainContent.classList.remove("hidden");
  });

  // Login
  loginForm.addEventListener("submit", (e) => {
    e.preventDefault();
    const email = document.getElementById("login-email").value;
    const password = document.getElementById("login-password").value;
    signInWithEmailAndPassword(auth, email, password)
      .then(() => {
        loginScreen.classList.add("hidden");
        mainContent.classList.remove("hidden");
      })
      .catch((err) => alert("Login failed: " + err.message));
  });

  // Signup
  signupForm.addEventListener("submit", (e) => {
    e.preventDefault();
    const email = document.getElementById("signup-email").value;
    const password = document.getElementById("signup-password").value;
    createUserWithEmailAndPassword(auth, email, password)
      .then(() => {
        alert("Account created!");
      })
      .catch((err) => alert("Signup failed: " + err.message));
  });

  // Forgot password
  forgotPasswordBtn.addEventListener("click", () => {
    const email = document.getElementById("login-email").value;
    if (!email) {
      alert("Enter your email first!");
      return;
    }
    sendPasswordResetEmail(auth, email)
      .then(() => alert("Password reset email sent!"))
      .catch((err) => alert("Error: " + err.message));
  });

  // Toggle password visibility
  togglePassword.addEventListener("click", () => {
    const pwd = document.getElementById("login-password");
    pwd.type = pwd.type === "password" ? "text" : "password";
  });
</script>

</body>
</html>
